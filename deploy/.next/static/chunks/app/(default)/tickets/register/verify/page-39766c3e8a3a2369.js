(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[319],{1695:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var i=n(5055);function o(e){let{loading:t,disabled:n,type:o="submit",className:r="",onClick:a,children:s}=e;return(0,i.jsxs)("button",{type:o,className:"".concat("btn btn-primary text-light"," ").concat(r).trim(),disabled:t||n,onClick:a,children:[t&&(0,i.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),s]})}n(8183)},3132:(e,t,n)=>{Promise.resolve().then(n.bind(n,4230)),Promise.resolve().then(n.t.bind(n,3300,23)),Promise.resolve().then(n.bind(n,6712))},4695:(e,t,n)=>{"use strict";n.d(t,{AU:()=>p,Br:()=>o,ML:()=>r,QL:()=>c,RY:()=>l,ZT:()=>s,kz:()=>d,oP:()=>u,v6:()=>a,vO:()=>i});class i extends Error{constructor(e,t){super(e),this.code=t}}function o(e){let t=new Date().getTime(),n=(null==e?void 0:e.registrationOpensAt)&&new Date(e.registrationOpensAt).getTime();return!!n&&!!(t<n)}function r(e){let t=new Date().getTime(),n=(null==e?void 0:e.registrationClosesAt)&&new Date(e.registrationClosesAt).getTime();return!!n&&!!(t>n)}async function a(e){let t="".concat(f(),"/public/otp"),n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!n.ok){let e=await n.json();throw Error((null==e?void 0:e.detail)||"Verification request failed.")}}async function s(e,t){let n="".concat(f(),"/public/").concat(e,"?signature=").concat(t),i=await fetch(n,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!i.ok){let e=await i.json();throw Error((null==e?void 0:e.detail)||"Cancellation failed.")}}async function l(e,t){let n="".concat(f(),"/public/verify"),i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,code:t})});if(!i.ok){let e=await i.json();throw Error((null==e?void 0:e.detail)||"Verification failed.")}return await i.json()}async function c(){let e="".concat(f(),"/public/availability"),t=await fetch(e,{method:"GET"});if(!t.ok){let e=await t.json();throw Error((null==e?void 0:e.detail)||"Failed to fetch availability.")}return await t.json()}async function u(e,t){let n="".concat(f(),"/public/").concat(e,"/tickets?signature=").concat(t),i=await fetch(n);if(404===i.status)return{tickets:[]};if(!i.ok){let e=await i.json();throw Error((null==e?void 0:e.detail)||"Failed to fetch tickets.")}return await i.json()}async function d(e,t,n,o,r,a){let s="".concat(f(),"/public/register"),l=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,firstName:t,lastName:n,additionalDetails:o,requestedTickets:r,verificationToken:a})});if(!l.ok){let e=await l.json();if((null==e?void 0:e.errorCode)==="validation")throw new i(e&&"object"==typeof e.errors&&null!==e.errors?Object.values(e.errors).flat().map(String).join(", "):String(e.errors),e.errorCode);throw new i((null==e?void 0:e.detail)||"Registration failed.",null==e?void 0:e.errorCode)}return!0}async function p(e,t,n){let o="".concat(f(),"/public/").concat(e,"/tickets?signature=").concat(t),r=await fetch(o,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({requestedTickets:n})});if(!r.ok){let e=await r.json();if((null==e?void 0:e.errorCode)==="validation")throw new i(e&&"object"==typeof e.errors&&null!==e.errors?Object.values(e.errors).flat().map(String).join(", "):String(e.errors),e.errorCode);throw new i((null==e?void 0:e.detail)||"Registration update failed.",null==e?void 0:e.errorCode)}return!0}function f(){let e=n(3946).R.admitto;return"".concat(e.baseUrl,"/teams/").concat(e.teamSlug,"/events/").concat(e.eventSlug)}},6712:(e,t,n)=>{"use strict";n.d(t,{default:()=>d});var i=n(5055),o=n(8183),r=n(1816),a=n(8611),s=n.n(a);function l(e){let{value:t,onChange:n}=e,r=(0,o.useRef)(null);return(0,o.useEffect)(()=>{var e;null==(e=r.current)||e.focus()},[]),(0,i.jsxs)("div",{className:s().otpWrapper,onClick:()=>{var e;return null==(e=r.current)?void 0:e.focus()},children:[(0,i.jsx)("input",{ref:r,type:"tel",inputMode:"numeric",autoComplete:"one-time-code",value:t.join(""),onChange:e=>{let i=e.target.value.replace(/\D/g,"").slice(0,t.length),o=[...t];for(let e=0;e<t.length;e++)o[e]=i[e]||"";n(o)},className:s().hiddenInput,"aria-label":"OTP code"}),t.map((e,t)=>(0,i.jsx)("div",{className:s().otpBox,children:e},t))]})}var c=n(1695),u=n(4695);function d(){let e=(0,r.useRouter)(),t=(0,r.useSearchParams)().get("email")||"",[n,a]=(0,o.useState)(["","","","","",""]),[s,d]=(0,o.useState)(!1),[p,f]=(0,o.useState)(""),h=async i=>{i.preventDefault(),d(!0),f("");let o=n.join("");try{let n=await (0,u.RY)(t,o);n.publicId?e.push("/tickets/edit/".concat(n.publicId,"/").concat(n.signature,"?redirect=true")):e.push("/tickets/register?token=".concat(encodeURIComponent(n.registrationToken),"&email=").concat(encodeURIComponent(t)))}catch(e){d(!1),f(e.message||"Verification failed. Please try again.")}};return(0,i.jsxs)("form",{onSubmit:h,className:"ticket-form",children:[p&&(0,i.jsx)("div",{className:"text-danger my-3",children:p}),(0,i.jsx)(l,{value:n,onChange:a}),(0,i.jsx)(c.A,{loading:s,disabled:n.some(e=>""===e),className:"mt-2",children:"Verify email"})]})}},8611:e=>{e.exports={otpWrapper:"OtpInput_otpWrapper__9YGEI",otpBox:"OtpInput_otpBox___kZDr",hiddenInput:"OtpInput_hiddenInput__YmK7f"}}},e=>{e.O(0,[386,758,739,853,429,358],()=>e(e.s=3132)),_N_E=e.O()}]);