(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[127],{1695:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var n=i(5055);function a(e){let{loading:t,disabled:i,type:a="submit",className:r="",onClick:o,children:s}=e;return(0,n.jsxs)("button",{type:a,className:"".concat("btn btn-primary text-light"," ").concat(r).trim(),disabled:t||i,onClick:o,children:[t&&(0,n.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),s]})}i(8183)},1744:(e,t,i)=>{Promise.resolve().then(i.bind(i,4230)),Promise.resolve().then(i.t.bind(i,3300,23)),Promise.resolve().then(i.bind(i,5487))},4695:(e,t,i)=>{"use strict";i.d(t,{AU:()=>f,Br:()=>a,ML:()=>r,QL:()=>c,RY:()=>l,ZT:()=>s,kz:()=>u,oP:()=>d,v6:()=>o,vO:()=>n});class n extends Error{constructor(e,t){super(e),this.code=t}}function a(e){let t=new Date().getTime(),i=(null==e?void 0:e.registrationOpensAt)&&new Date(e.registrationOpensAt).getTime();return!!i&&!!(t<i)}function r(e){let t=new Date().getTime(),i=(null==e?void 0:e.registrationClosesAt)&&new Date(e.registrationClosesAt).getTime();return!!i&&!!(t>i)}async function o(e){let t="".concat(m(),"/public/otp"),i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!i.ok){let e=await i.json();throw Error((null==e?void 0:e.detail)||"Verification request failed.")}}async function s(e,t){let i="".concat(m(),"/public/").concat(e,"?signature=").concat(t),n=await fetch(i,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!n.ok){let e=await n.json();throw Error((null==e?void 0:e.detail)||"Cancellation failed.")}}async function l(e,t){let i="".concat(m(),"/public/verify"),n=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,code:t})});if(!n.ok){let e=await n.json();throw Error((null==e?void 0:e.detail)||"Verification failed.")}return await n.json()}async function c(){let e="".concat(m(),"/public/availability"),t=await fetch(e,{method:"GET"});if(!t.ok){let e=await t.json();throw Error((null==e?void 0:e.detail)||"Failed to fetch availability.")}return await t.json()}async function d(e,t){let i="".concat(m(),"/public/").concat(e,"/tickets?signature=").concat(t),n=await fetch(i);if(404===n.status)return{tickets:[]};if(!n.ok){let e=await n.json();throw Error((null==e?void 0:e.detail)||"Failed to fetch tickets.")}return await n.json()}async function u(e,t,i,a,r,o){let s="".concat(m(),"/public/register"),l=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,firstName:t,lastName:i,additionalDetails:a,requestedTickets:r,verificationToken:o})});if(!l.ok){let e=await l.json();if((null==e?void 0:e.errorCode)==="validation")throw new n(e&&"object"==typeof e.errors&&null!==e.errors?Object.values(e.errors).flat().map(String).join(", "):String(e.errors),e.errorCode);throw new n((null==e?void 0:e.detail)||"Registration failed.",null==e?void 0:e.errorCode)}return!0}async function f(e,t,i){let a="".concat(m(),"/public/").concat(e,"/tickets?signature=").concat(t),r=await fetch(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({requestedTickets:i})});if(!r.ok){let e=await r.json();if((null==e?void 0:e.errorCode)==="validation")throw new n(e&&"object"==typeof e.errors&&null!==e.errors?Object.values(e.errors).flat().map(String).join(", "):String(e.errors),e.errorCode);throw new n((null==e?void 0:e.detail)||"Registration update failed.",null==e?void 0:e.errorCode)}return!0}function m(){let e=i(3946).R.admitto;return"".concat(e.baseUrl,"/teams/").concat(e.teamSlug,"/events/").concat(e.eventSlug)}},5487:(e,t,i)=>{"use strict";i.d(t,{default:()=>l});var n=i(5055),a=i(8183),r=i(1816),o=i(1695),s=i(4695);function l(){var e,t;let[i,l]=(0,a.useState)(""),[c,d]=(0,a.useState)(!1),[u,f]=(0,a.useState)(""),m=(0,r.useRouter)(),h=(0,a.useRef)(null),p=async e=>{e.preventDefault(),d(!0),f("");try{await (0,s.v6)(i),m.push("/tickets/register/verify?email=".concat(encodeURIComponent(i)))}catch(e){d(!1),f(e.message||"Verification request failed. Please try again.")}};return(0,n.jsx)("div",{className:"w-75 mx-auto text-center",children:(0,n.jsxs)("form",{ref:h,onSubmit:p,className:"ticket-form",children:[u&&(0,n.jsx)("div",{className:"text-danger mt-2",children:u}),(0,n.jsxs)("div",{className:"form-group row justify-content-center align-items-center mb-2",children:[(0,n.jsx)("label",{htmlFor:"email",className:"col-auto col-form-label text-end",children:"Email:"}),(0,n.jsx)("div",{className:"col-9",children:(0,n.jsx)("input",{type:"email",id:"email",value:i,onChange:e=>l(e.target.value),required:!0,className:"form-control"})})]}),(0,n.jsx)(o.A,{loading:c,disabled:!(null!=(t=null==(e=h.current)?void 0:e.checkValidity())&&t),className:"mt-2",children:"Start registration"})]})})}}},e=>{e.O(0,[386,758,739,853,429,358],()=>e(e.s=1744)),_N_E=e.O()}]);