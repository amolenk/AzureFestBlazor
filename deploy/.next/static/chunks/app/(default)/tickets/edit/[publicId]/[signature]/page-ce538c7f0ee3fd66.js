(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[246],{1695:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var n=i(5055);function a(e){let{loading:t,disabled:i,type:a="submit",className:r="",onClick:s,children:o}=e;return(0,n.jsxs)("button",{type:a,className:"".concat("btn btn-primary text-light"," ").concat(r).trim(),disabled:t||i,onClick:s,children:[t&&(0,n.jsx)("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),o]})}i(8183)},2487:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var n=i(5055);function a(e){let{error:t}=e;return(0,n.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,n.jsxs)("div",{className:"card h-100 shadow-sm w-50",children:[(0,n.jsx)("div",{className:"card-header text-danger text-center",children:(0,n.jsx)("h3",{children:"Unexpected Error"})}),(0,n.jsx)("div",{className:"card-body lead text-center",children:t})]})})}i(8183)},4695:(e,t,i)=>{"use strict";i.d(t,{AU:()=>h,Br:()=>a,ML:()=>r,QL:()=>l,RY:()=>c,ZT:()=>o,kz:()=>u,oP:()=>d,v6:()=>s,vO:()=>n});class n extends Error{constructor(e,t){super(e),this.code=t}}function a(e){let t=new Date().getTime(),i=(null==e?void 0:e.registrationOpensAt)&&new Date(e.registrationOpensAt).getTime();return!!i&&!!(t<i)}function r(e){let t=new Date().getTime(),i=(null==e?void 0:e.registrationClosesAt)&&new Date(e.registrationClosesAt).getTime();return!!i&&!!(t>i)}async function s(e){let t="".concat(f(),"/public/otp"),i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!i.ok){let e=await i.json();throw Error((null==e?void 0:e.detail)||"Verification request failed.")}}async function o(e,t){let i="".concat(f(),"/public/").concat(e,"?signature=").concat(t),n=await fetch(i,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!n.ok){let e=await n.json();throw Error((null==e?void 0:e.detail)||"Cancellation failed.")}}async function c(e,t){let i="".concat(f(),"/public/verify"),n=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,code:t})});if(!n.ok){let e=await n.json();throw Error((null==e?void 0:e.detail)||"Verification failed.")}return await n.json()}async function l(){let e="".concat(f(),"/public/availability"),t=await fetch(e,{method:"GET"});if(!t.ok){let e=await t.json();throw Error((null==e?void 0:e.detail)||"Failed to fetch availability.")}return await t.json()}async function d(e,t){let i="".concat(f(),"/public/").concat(e,"/tickets?signature=").concat(t),n=await fetch(i);if(404===n.status)return{tickets:[]};if(!n.ok){let e=await n.json();throw Error((null==e?void 0:e.detail)||"Failed to fetch tickets.")}return await n.json()}async function u(e,t,i,a,r,s){let o="".concat(f(),"/public/register"),c=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,firstName:t,lastName:i,additionalDetails:a,requestedTickets:r,verificationToken:s})});if(!c.ok){let e=await c.json();if((null==e?void 0:e.errorCode)==="validation")throw new n(e&&"object"==typeof e.errors&&null!==e.errors?Object.values(e.errors).flat().map(String).join(", "):String(e.errors),e.errorCode);throw new n((null==e?void 0:e.detail)||"Registration failed.",null==e?void 0:e.errorCode)}return!0}async function h(e,t,i){let a="".concat(f(),"/public/").concat(e,"/tickets?signature=").concat(t),r=await fetch(a,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({requestedTickets:i})});if(!r.ok){let e=await r.json();if((null==e?void 0:e.errorCode)==="validation")throw new n(e&&"object"==typeof e.errors&&null!==e.errors?Object.values(e.errors).flat().map(String).join(", "):String(e.errors),e.errorCode);throw new n((null==e?void 0:e.detail)||"Registration update failed.",null==e?void 0:e.errorCode)}return!0}function f(){let e=i(3946).R.admitto;return"".concat(e.baseUrl,"/teams/").concat(e.teamSlug,"/events/").concat(e.eventSlug)}},5910:(e,t,i)=>{Promise.resolve().then(i.bind(i,4230)),Promise.resolve().then(i.t.bind(i,3300,23)),Promise.resolve().then(i.bind(i,6473))},6473:(e,t,i)=>{"use strict";i.d(t,{default:()=>u});var n=i(5055),a=i(3783),r=i.n(a),s=i(8183),o=i(4695),c=i(3946),l=i(2487),d=i(1695);function u(e){let{publicId:t,signature:i}=e,[a,u]=(0,s.useState)(!0),[h,f]=(0,s.useState)(""),[m,v]=(0,s.useState)(!1),[j,p]=(0,s.useState)(""),[g,y]=(0,s.useState)(""),[x,w]=(0,s.useState)(null),[b,k]=(0,s.useState)(!1),N=c.R.admitto.mainConferenceTicketSlug;(0,s.useEffect)(()=>{!async function(){try{let[e,n]=await Promise.all([(0,o.QL)(),(0,o.oP)(t,i)]);w(e),k((n.tickets||[]).includes(N)),n.tickets&&0!==n.tickets.length||f("No existing registration found with the provided link.")}catch(e){f(e.message||"Could not fetch ticket availability.")}finally{u(!1)}}()},[t,i,N]);let C=(0,s.useMemo)(()=>{let e=null==x?void 0:x.ticketTypes.find(e=>e.slug===N);return!!(null==e?void 0:e.hasCapacity)},[x,N]),S=async()=>{v(!0),p(""),y("");try{await (0,o.AU)(t,i,[N]),k(!0),y("Registration updated successfully.")}catch(e){p(e.message||"Registration update failed. Please try again.")}finally{v(!1)}};return a?(0,n.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,n.jsx)("div",{className:"spinner-border text-primary",role:"status",children:(0,n.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):h?(0,n.jsx)(l.A,{error:h}):x&&(0,o.ML)(x)?(0,n.jsxs)("div",{className:"card h-100 shadow-sm",children:[(0,n.jsx)("div",{className:"card-header text-center",children:(0,n.jsx)("h3",{children:"Registration is closed"})}),(0,n.jsx)("div",{className:"card-body text-center",children:"Registration for this event has closed. See you next time!"})]}):(0,n.jsx)("div",{className:"mx-auto",children:(0,n.jsxs)("div",{className:"card h-100 shadow-sm mb-4",children:[(0,n.jsx)("div",{className:"card-header text-center",children:(0,n.jsx)("h3",{children:"Your Registration"})}),(0,n.jsxs)("div",{className:"card-body text-center",children:[b?(0,n.jsx)("p",{children:"You are already registered for Azure Fest general admission."}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:"This registration does not currently include a conference ticket."}),C?(0,n.jsx)(d.A,{type:"button",loading:m,className:"mt-2",onClick:S,children:"Claim conference ticket"}):(0,n.jsx)("p",{className:"text-danger",children:"General admission is sold out."})]}),j&&(0,n.jsx)("div",{className:"text-danger mt-3",children:j}),g&&(0,n.jsx)("div",{className:"text-success mt-3",children:g}),(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(r(),{href:"/tickets/cancel/".concat(t,"/").concat(i),className:"btn btn-danger",children:"Cancel Registration"})})]})]})})}}},e=>{e.O(0,[386,758,739,853,429,358],()=>e(e.s=5910)),_N_E=e.O()}]);